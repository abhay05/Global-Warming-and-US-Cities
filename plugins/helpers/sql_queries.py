class SqlQueries:
    InsertIntoDimCityPop=("""insert into dim_city_pop select cast(year as int),cast(population as int),city,state from (select split_part(year,' ',1) as year,regexp_replace(population,' ','') as population,city,state from staging_city_population where year!='' and population!='(NRS)') where population !='(NA)'""")
    InsertIntoDimLandTemp=("""insert into dim_land_temp select dt,city,averageTemperature,averageTemperatureUncertainty from (select row_number() over(partition by city,dt) rn,dt,city,averageTemperature,averageTemperatureUncertainty from staging_global_land_temp where dt is not null and city is not NULL and averageTemperature is not NULL) where rn=1""")
    InsertIntoDimCity=("""insert into dim_city select city,country,latitude,longitude from (select row_number() over(partition by city) rn,city,country,latitude,longitude from staging_global_land_temp) g where rn=1""")
    InsertIntoDimTime=("""insert into dim_time select dt,year,month,day from (select row_number() over(partition by dt) rn,dt, extract(year from dt) as year,extract(month from dt) as month, extract(day from dt) as day from staging_global_land_temp) where rn=1""")
    InsertIntoFactCityTempNPop=("""insert into fact_city_temp_n_pop select md5(year::varchar || city::varchar) as id,year,city,country,state,population,averageTemperature,averageTemperatureUncertainty from (select b.year as year,c.city as city,c.country as country,a.state as state,a.population as population, b.averageTemperature as averageTemperature,b.averageTemperatureUncertainty as averageTemperatureUncertainty from dim_city_pop a join (select a.year as year,b.city as city,avg(b.averageTemperature) as averageTemperature,avg(b.averageTemperatureUncertainty) as averageTemperatureUncertainty from dim_time a join dim_land_temp b on a.dt=b.dt group by year,city) b on (a.year=b.year and a.city=b.city) join dim_city c on c.city=a.city)""")